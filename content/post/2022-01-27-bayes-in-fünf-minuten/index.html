---
title: Bayes in f√ºnf Minuten
author: Sebastian Sauer
date: '2022-01-27'
slug: bayes-in-f√ºnf-minuten
categories:
  - rstats
tags:
  - Bayes
  - modelling
editor_options: 
  chunk_output_type: console
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>


<div id="das-ist-ein-f√ºnf-minuten-bayes-kurs" class="section level1">
<h1>Das ist ein F√ºnf-Minuten-Bayes-Kurs</h1>
<p>Sie w√ºrden gerne Bayes lernen und daf√ºr zwischen 1-3 Wochen Zeit investieren?
Dann sind Sie hier falsch.
Dieser Post zeigt einen Kurz√ºberblick in Bayes-Statistik in f√ºnf Minuten.
Naja, ich probiere es jedenfalls.</p>
</div>
<div id="forschungsfrage" class="section level1">
<h1>Forschungsfrage</h1>
<p>Sagen wir, uns interessiert folgende Forschungsfrage, die mit Methoden der Inferenz-Statistik untersucht werden soll.
In diesem Fall Bayes-Inferenz (nicht Frequentistische Statistik).</p>
<blockquote>
<p>Verbrauchen Autos mit Automatik-Getriebe im Durchschnitt mehr Sprit als Autos mit manuellem Getriebe?</p>
</blockquote>
<ul>
<li>AV: mpg (miles per gallone)</li>
<li>UV: am (automatic vs.¬†manual)</li>
</ul>
<p>Die AV ist metrisch. Die UV ist bin√§r. Wir vergleichen also zwei Gruppen,
das ist √§hnlich zum t-Test.</p>
</div>
<div id="vorbereitung" class="section level1">
<h1>Vorbereitung</h1>
<pre class="r"><code>data(&quot;mtcars&quot;)  # Datensatz laden
library(rstanarm)  # Funktionen f√ºr Bayes-Statistik laden
library(tidyverse)  # F√ºr Datenjudo</code></pre>
<p>Der Datensatz <code>mtcars</code> ist ‚Äúfest eingebaut‚Äù in R, so dass wir ihn nicht irgendwo herunterladen m√ºssen.</p>
<p>Hilfe zum Datensatz bekommt man so:</p>
<pre class="r"><code>help(mtcars) # Hilfe/Codebook zum Datensatz 
# Output hier nicht dargestellt</code></pre>
</div>
<div id="visualisierung" class="section level1">
<h1>Visualisierung</h1>
<p>Zwar nicht Gegenstand dieses Posts,
aber hilfreich,
daher hier nur kurz ein Bild ohne Syntax:</p>
<p><img src="chunk-img/unnamed-chunk-4-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Jeder (leicht verwackelte) Punkt stellt ein Auto dar.
Die Line ist die Regressionsgerade.
Die roten Punkte sind die Mittelwerte der beiden Gruppen.</p>
</div>
<div id="zur-interpretation-der-regression" class="section level1">
<h1>Zur Interpretation der Regression</h1>
<p>Die einfache Regression (also mit nur einer UV) hat zwei Koeffizienten:
Achsenabschnitt und Steigung.</p>
<p>Bei einer bin√§ren (zweistufigen) UV bedeutet das:</p>
<ul>
<li>Der Achsenabschnitt zeigt den vorhergesagten Wert (der Mittelwert) der 1. Gruppe.</li>
<li>Die Steigung zeigt den (vorhergesagten) Unterschied der zweiten Gruppe (im Vergleich zur 1. Gruppe).</li>
</ul>
<p>Der vorhergesagte Wert der zweiten Gruppe ergibt sich also als Summe von Achsenabschnitt plus Steigung.</p>
</div>
<div id="modell-berechnen" class="section level1">
<h1>Modell berechnen</h1>
<p>Nutzen wir das allgemeine (oder verallgemeinerte) lineare Modell,
um unsere Forschungsfrage zu beantworten.
Anders gesagt: Wir berechnen einen Regression.
Das sch√∂ne an einer Regression ist,
sie passt<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> auf die meisten Probleme,
so √§hnlich wie ein Schweizer Taschenmesser.</p>
<pre class="r"><code>m1 &lt;- stan_glm(mpg ~ am, data = mtcars)</code></pre>
<p>Sch√∂n oder: Die Syntax von <code>stan_glm()</code> entspricht der Syntax von <code>lm()</code>.</p>
</div>
<div id="unterschied-zwischen-den-zwei-gruppen" class="section level1">
<h1>Unterschied zwischen den zwei Gruppen</h1>
<pre class="r"><code>coef(m1)</code></pre>
<pre><code>## (Intercept)          am 
##   17.176251    7.168571</code></pre>
<p>Was wir bekommen,
sind Punktsch√§tzer f√ºr die Population:</p>
<p>Der Achsenabschnitt wird auf ca. 17 gesch√§tzt.
Die Steigung (Unterschied zwischen den Gruppen) wird auf ca. 7 gesch√§tzt.</p>
</div>
<div id="aber-ist-der-unterschied-zwischen-den-gruppen-signifikant" class="section level1">
<h1>Aber ist der Unterschied zwischen den Gruppen ‚Äúsignifikant‚Äù?</h1>
<p>In Bayes gibt es das Wort ‚Äúsignifikant‚Äù nicht.
Formulieren wir die Frage doch so um:</p>
<blockquote>
<p>Liegt der Wert ‚ÄúNull‚Äù innerhalb oder au√üerhalb des 90%-Konfidenzintervalls (KI)?</p>
</blockquote>
<pre class="r"><code>posterior_interval(m1)</code></pre>
<pre><code>##                    5%       95%
## (Intercept) 15.231152 19.063431
## am           4.159553 10.242292
## sigma        4.040905  6.219674</code></pre>
<p>Das 90%-KI wird auf den Bereich von ca. 4 bis 10 gesch√§tzt.
Die Null liegt <em>nicht</em> in diesem Intervall.</p>
<p>Folglich verwerfen wir die Nullhypothese.</p>
</div>
<div id="ich-h√§tte-aber-lieber-ein-89-oder-ein-95-ki" class="section level1">
<h1>Ich h√§tte aber lieber ein 89% oder ein 95%-KI!</h1>
<p>Also gut‚Ä¶</p>
<pre class="r"><code>posterior_interval(m1, prob = .89)  # oder auch prob = .95 etc.</code></pre>
<pre><code>##                  5.5%     94.5%
## (Intercept) 15.289955 19.019949
## am           4.255656 10.154517
## sigma        4.071641  6.167259</code></pre>
</div>
<div id="warum-eigentlich-89" class="section level1">
<h1>Warum eigentlich 89%?</h1>
<p>Richard McElreath begr√ºndet die 89 so: Es ist die kleinste Primzahl kleiner als 95.
Noch Fragen? üòÑ</p>
</div>
<div id="mit-welcher-wahrscheinlichkeit-ist-der-unterschied-gr√∂√üer-als-null" class="section level1">
<h1>Mit welcher Wahrscheinlichkeit ist der Unterschied gr√∂√üer als Null?</h1>
<p>Eine interessante Variante der Forschungsfrage ist zu fragen,
mit welcher Wahrscheinlichkeit - basierend auf den Daten und dem Modell -
man mit einem Unterschied gr√∂√üer als Null zwischen Gruppen rechnen kann?</p>
<pre class="r"><code>m1 %&gt;% 
  as_tibble() %&gt;%  # Modellergebnis in Tabelle (tibble) umwandeln
  count(am &gt; 0)  # Z√§hlen wie oft `am &gt; 0` der Fall ist</code></pre>
<pre><code>## # A tibble: 1 √ó 2
##   `am &gt; 0`     n
##   &lt;lgl&gt;    &lt;int&gt;
## 1 TRUE      4000</code></pre>
<p>Wie man sieht,
findet das Modell in allen 4000 Stichproben (4000 ist der Defaultwert)
einen Unterschied gr√∂√üer Null.</p>
<p>Wir res√ºmieren also:</p>
<blockquote>
<p>Laut Modell betr√§gt die Wahrscheinlichkeit praktisch 100%, dass wir einen Unterschied gr√∂√üer Null zwischen den Gruppenmittelwerten finden.</p>
</blockquote>
</div>
<div id="fertig" class="section level1">
<h1>Fertig</h1>
<p>Ich fasse zusammen. Wir haben gerade Bayes-Statistik betrieben.
Und zwar haben wir ein einfaches Regressionsmodell, analog zum t-Test, berechnet.
Dann haben wir ein Bayes-Analog zur Nullhypothese und zum Konfidenzintervall uns ausgeben lassen.</p>
</div>
<div id="interpretation-der-ergebnisse" class="section level1">
<h1>Interpretation der Ergebnisse</h1>
<p>Im Frequentismus sind die zentralen Statistiken schwierig zu interpretieren.</p>
<p>In der Bayes-Statistik ist es einfach.
Wir k√∂nnen sagen, dass (laut Modell!) der (mittlere) Gruppenunterschie mit 90% Wahrscheinlichkeit zwischen 4 und 10 Gallonen Sprit liegt.</p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>Oft ist sie nur eine N√§herung und manchmal eine schlechte, aber man kann erstaunlich viel mit der Regression machen, auch nicht-lineare wie polynombasierte oder exponentielle Zusammenh√§nge modellieren.<a href="#fnref1" class="footnote-back">‚Ü©Ô∏é</a></p></li>
</ol>
</div>
