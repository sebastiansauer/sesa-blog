---
title: 'Modelling movie successes: linear regression'
author: Sebastian Sauer
date: '2021-02-24'
slug: modelling-movie-successes-linear-regression
categories:
  - rstats
tags:
  - tutorial
output:
  blogdown::html_page:
    toc: yes
    number_sections: yes
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>

<div id="TOC">
<ul>
<li><a href="#load-packages"><span class="toc-section-number">1</span> Load packages</a></li>
<li><a href="#load-data"><span class="toc-section-number">2</span> Load data</a></li>
<li><a href="#research-question"><span class="toc-section-number">3</span> Research question</a></li>
<li><a href="#get-overview"><span class="toc-section-number">4</span> Get overview</a>
<ul>
<li><a href="#descriptive-statistics"><span class="toc-section-number">4.1</span> Descriptive statistics</a></li>
<li><a href="#missing-values"><span class="toc-section-number">4.2</span> Missing values</a></li>
<li><a href="#distribution-of-the-output-variable"><span class="toc-section-number">4.3</span> Distribution of the output variable</a></li>
<li><a href="#distribution-of-the-predictors"><span class="toc-section-number">4.4</span> Distribution of the predictors</a></li>
<li><a href="#transform-budget-via-logarithm"><span class="toc-section-number">4.5</span> Transform budget (via logarithm)</a></li>
<li><a href="#ggscatterstats"><span class="toc-section-number">4.6</span> ggscatterstats</a></li>
<li><a href="#pivot-data-set"><span class="toc-section-number">4.7</span> Pivot data set</a></li>
<li><a href="#drop-unused-variables"><span class="toc-section-number">4.8</span> Drop unused variables</a></li>
<li><a href="#drop-cases-with-missing-values"><span class="toc-section-number">4.9</span> Drop cases with missing values</a></li>
</ul></li>
<li><a href="#model-0"><span class="toc-section-number">5</span> Model 0</a></li>
<li><a href="#model-1-budget_log10"><span class="toc-section-number">6</span> Model 1: <code>budget_log10</code></a></li>
<li><a href="#model-2-adding-number-of-votes"><span class="toc-section-number">7</span> Model 2: Adding number of votes</a></li>
<li><a href="#model-3-number-of-votes-quadratic"><span class="toc-section-number">8</span> Model 3: Number of votes, quadratic</a></li>
<li><a href="#model-4-number-of-votes-3rd-degree"><span class="toc-section-number">9</span> Model 4: Number of votes, 3rd degree</a></li>
<li><a href="#model-5-multiple-regression"><span class="toc-section-number">10</span> Model 5: Multiple regression</a></li>
<li><a href="#model-6-interaction"><span class="toc-section-number">11</span> Model 6: Interaction</a></li>
<li><a href="#model-selection-anova"><span class="toc-section-number">12</span> Model selection: ANOVA</a></li>
<li><a href="#regression-diagnostics-testing-the-assumptions"><span class="toc-section-number">13</span> Regression diagnostics: testing the assumptions</a></li>
<li><a href="#reproducibility"><span class="toc-section-number">14</span> Reproducibility</a></li>
</ul>
</div>

<div id="load-packages" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Load packages</h1>
<pre class="r"><code>library(tidyverse)  # data wrangling
library(broom)  # nice formatting of output
library(skimr)  # gives overview on descriptives
library(ggfortify)  # plotting regression diagnostics
library(ggstatsplot)  # fancy scatter plot</code></pre>
</div>
<div id="load-data" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Load data</h1>
<p>Load this package to access the data set:</p>
<pre class="r"><code>library(ggplot2movies)
data(movies)</code></pre>
<p><a href="https://rdrr.io/cran/ggplot2movies/man/movies.html">Here</a> is some explanation on the data set.</p>
<p>Alternatively, load the data from a csv file:</p>
<pre class="r"><code>movies &lt;- read_csv(&quot;https://vincentarelbundock.github.io/Rdatasets/csv/ggplot2movies/movies.csv&quot;)
glimpse(movies)
#&gt; Rows: 58,788
#&gt; Columns: 25
#&gt; $ X1          &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,…
#&gt; $ title       &lt;chr&gt; &quot;$&quot;, &quot;$1000 a Touchdown&quot;, &quot;$21 a Day Once a Month&quot;, &quot;$40,0…
#&gt; $ year        &lt;dbl&gt; 1971, 1939, 1941, 1996, 1975, 2000, 2002, 2002, 1987, 1917…
#&gt; $ length      &lt;dbl&gt; 121, 71, 7, 70, 71, 91, 93, 25, 97, 61, 99, 96, 10, 10, 10…
#&gt; $ budget      &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
#&gt; $ rating      &lt;dbl&gt; 6.4, 6.0, 8.2, 8.2, 3.4, 4.3, 5.3, 6.7, 6.6, 6.0, 5.4, 5.9…
#&gt; $ votes       &lt;dbl&gt; 348, 20, 5, 6, 17, 45, 200, 24, 18, 51, 23, 53, 44, 11, 12…
#&gt; $ r1          &lt;dbl&gt; 4.5, 0.0, 0.0, 14.5, 24.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4…
#&gt; $ r2          &lt;dbl&gt; 4.5, 14.5, 0.0, 0.0, 4.5, 4.5, 0.0, 4.5, 4.5, 0.0, 0.0, 0.…
#&gt; $ r3          &lt;dbl&gt; 4.5, 4.5, 0.0, 0.0, 0.0, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5…
#&gt; $ r4          &lt;dbl&gt; 4.5, 24.5, 0.0, 0.0, 14.5, 14.5, 4.5, 4.5, 0.0, 4.5, 14.5,…
#&gt; $ r5          &lt;dbl&gt; 14.5, 14.5, 0.0, 0.0, 14.5, 14.5, 24.5, 4.5, 0.0, 4.5, 24.…
#&gt; $ r6          &lt;dbl&gt; 24.5, 14.5, 24.5, 0.0, 4.5, 14.5, 24.5, 14.5, 0.0, 44.5, 4…
#&gt; $ r7          &lt;dbl&gt; 24.5, 14.5, 0.0, 0.0, 0.0, 4.5, 14.5, 14.5, 34.5, 14.5, 24…
#&gt; $ r8          &lt;dbl&gt; 14.5, 4.5, 44.5, 0.0, 0.0, 4.5, 4.5, 14.5, 14.5, 4.5, 4.5,…
#&gt; $ r9          &lt;dbl&gt; 4.5, 4.5, 24.5, 34.5, 0.0, 14.5, 4.5, 4.5, 4.5, 4.5, 14.5,…
#&gt; $ r10         &lt;dbl&gt; 4.5, 14.5, 24.5, 45.5, 24.5, 14.5, 14.5, 14.5, 24.5, 4.5, …
#&gt; $ mpaa        &lt;chr&gt; NA, NA, NA, NA, NA, NA, &quot;R&quot;, NA, NA, NA, NA, NA, NA, NA, &quot;…
#&gt; $ Action      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0…
#&gt; $ Animation   &lt;dbl&gt; 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1…
#&gt; $ Comedy      &lt;dbl&gt; 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1…
#&gt; $ Drama       &lt;dbl&gt; 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0…
#&gt; $ Documentary &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0…
#&gt; $ Romance     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
#&gt; $ Short       &lt;dbl&gt; 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1…</code></pre>
</div>
<div id="research-question" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Research question</h1>
<p><strong>Which factors are predictive for movie success?</strong></p>
<p>We’ll take the movie rating as the output variable (the y-variable).</p>
</div>
<div id="get-overview" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Get overview</h1>
<div id="descriptive-statistics" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Descriptive statistics</h2>
<pre class="r"><code>skim(movies)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-3">Table 4.1: </span>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">movies</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">58788</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">25</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">23</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">title</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">121</td>
<td align="right">0</td>
<td align="right">56007</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">mpaa</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="right">53864</td>
<td align="right">5</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<colgroup>
<col width="11%" />
<col width="8%" />
<col width="11%" />
<col width="10%" />
<col width="10%" />
<col width="4%" />
<col width="8%" />
<col width="8%" />
<col width="10%" />
<col width="10%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">X</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">29394.50</td>
<td align="right">16970.78</td>
<td align="right">1</td>
<td align="right">14697.75</td>
<td align="right">29394.5</td>
<td align="right">44091.25</td>
<td align="right">58788.0</td>
<td align="left">▇▇▇▇▇</td>
</tr>
<tr class="even">
<td align="left">year</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">1976.13</td>
<td align="right">23.74</td>
<td align="right">1893</td>
<td align="right">1958.00</td>
<td align="right">1983.0</td>
<td align="right">1997.00</td>
<td align="right">2005.0</td>
<td align="left">▁▁▃▃▇</td>
</tr>
<tr class="odd">
<td align="left">length</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">82.34</td>
<td align="right">44.35</td>
<td align="right">1</td>
<td align="right">74.00</td>
<td align="right">90.0</td>
<td align="right">100.00</td>
<td align="right">5220.0</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">budget</td>
<td align="right">53573</td>
<td align="right">0.09</td>
<td align="right">13412513.25</td>
<td align="right">23350084.93</td>
<td align="right">0</td>
<td align="right">250000.00</td>
<td align="right">3000000.0</td>
<td align="right">15000000.00</td>
<td align="right">200000000.0</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">rating</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">5.93</td>
<td align="right">1.55</td>
<td align="right">1</td>
<td align="right">5.00</td>
<td align="right">6.1</td>
<td align="right">7.00</td>
<td align="right">10.0</td>
<td align="left">▁▃▇▆▁</td>
</tr>
<tr class="even">
<td align="left">votes</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">632.13</td>
<td align="right">3829.62</td>
<td align="right">5</td>
<td align="right">11.00</td>
<td align="right">30.0</td>
<td align="right">112.00</td>
<td align="right">157608.0</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">r1</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">7.01</td>
<td align="right">10.94</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">4.5</td>
<td align="right">4.50</td>
<td align="right">100.0</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">r2</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">4.02</td>
<td align="right">5.96</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">4.5</td>
<td align="right">4.50</td>
<td align="right">84.5</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">r3</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">4.72</td>
<td align="right">6.45</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">4.5</td>
<td align="right">4.50</td>
<td align="right">84.5</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">r4</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">6.37</td>
<td align="right">7.59</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">4.5</td>
<td align="right">4.50</td>
<td align="right">100.0</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">r5</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">9.80</td>
<td align="right">9.73</td>
<td align="right">0</td>
<td align="right">4.50</td>
<td align="right">4.5</td>
<td align="right">14.50</td>
<td align="right">100.0</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">r6</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">13.04</td>
<td align="right">10.98</td>
<td align="right">0</td>
<td align="right">4.50</td>
<td align="right">14.5</td>
<td align="right">14.50</td>
<td align="right">84.5</td>
<td align="left">▇▂▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">r7</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">15.55</td>
<td align="right">11.59</td>
<td align="right">0</td>
<td align="right">4.50</td>
<td align="right">14.5</td>
<td align="right">24.50</td>
<td align="right">100.0</td>
<td align="left">▇▃▁▁▁</td>
</tr>
<tr class="even">
<td align="left">r8</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">13.88</td>
<td align="right">11.32</td>
<td align="right">0</td>
<td align="right">4.50</td>
<td align="right">14.5</td>
<td align="right">24.50</td>
<td align="right">100.0</td>
<td align="left">▇▃▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">r9</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">8.95</td>
<td align="right">9.44</td>
<td align="right">0</td>
<td align="right">4.50</td>
<td align="right">4.5</td>
<td align="right">14.50</td>
<td align="right">100.0</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">r10</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">16.85</td>
<td align="right">15.65</td>
<td align="right">0</td>
<td align="right">4.50</td>
<td align="right">14.5</td>
<td align="right">24.50</td>
<td align="right">100.0</td>
<td align="left">▇▃▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">Action</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">0.08</td>
<td align="right">0.27</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0.0</td>
<td align="right">0.00</td>
<td align="right">1.0</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">Animation</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">0.06</td>
<td align="right">0.24</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0.0</td>
<td align="right">0.00</td>
<td align="right">1.0</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">Comedy</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">0.29</td>
<td align="right">0.46</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0.0</td>
<td align="right">1.00</td>
<td align="right">1.0</td>
<td align="left">▇▁▁▁▃</td>
</tr>
<tr class="even">
<td align="left">Drama</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">0.37</td>
<td align="right">0.48</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0.0</td>
<td align="right">1.00</td>
<td align="right">1.0</td>
<td align="left">▇▁▁▁▅</td>
</tr>
<tr class="odd">
<td align="left">Documentary</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">0.06</td>
<td align="right">0.24</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0.0</td>
<td align="right">0.00</td>
<td align="right">1.0</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">Romance</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">0.08</td>
<td align="right">0.27</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0.0</td>
<td align="right">0.00</td>
<td align="right">1.0</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">Short</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">0.16</td>
<td align="right">0.37</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0.0</td>
<td align="right">0.00</td>
<td align="right">1.0</td>
<td align="left">▇▁▁▁▂</td>
</tr>
</tbody>
</table>
</div>
<div id="missing-values" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Missing values</h2>
<pre class="r"><code>movies %&gt;% 
  summarise(budget_na = sum(is.na(budget))) 
#&gt;   budget_na
#&gt; 1     53573</code></pre>
<p>Or all columns in one go:</p>
<pre class="r"><code>movies %&gt;% 
  summarise(across(everything(), ~ sum(is.na(.))))
#&gt;   X title year length budget rating votes r1 r2 r3 r4 r5 r6 r7 r8 r9 r10 mpaa
#&gt; 1 0     0    0      0  53573      0     0  0  0  0  0  0  0  0  0  0   0    0
#&gt;   Action Animation Comedy Drama Documentary Romance Short
#&gt; 1      0         0      0     0           0       0     0</code></pre>
</div>
<div id="distribution-of-the-output-variable" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Distribution of the output variable</h2>
<pre class="r"><code>movies %&gt;% 
  ggplot(aes(x = rating)) +
  geom_histogram()</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="distribution-of-the-predictors" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Distribution of the predictors</h2>
<pre class="r"><code>movies %&gt;% 
  mutate(across(where(is.integer), as.numeric)) %&gt;%  # Integervariable als numerisch deklarieren
  select(where(is.numeric)) %&gt;%  # alle numerischen Variablen auswählen
  pivot_longer(everything(), names_to = &quot;variable&quot;) %&gt;%  # auf langes Format pivotieren
  ggplot(aes(x = value)) +
  geom_histogram() +
  facet_wrap(~ variable, scales = &quot;free&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-7-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="transform-budget-via-logarithm" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Transform budget (via logarithm)</h2>
<pre class="r"><code>movies %&gt;% 
  mutate(budget_log10 = log10(budget)) -&gt; movies2</code></pre>
<p>Remove the original variable:</p>
<pre class="r"><code>movies2 %&gt;% 
  select(budget_log10, everything()) %&gt;%   # &quot;budget_log10&quot; als erste Spalte
  select(-budget) -&gt; movies2</code></pre>
<p>There were some 0 (zero) values in the data set. Taking the logarithm of zero leads to doom. Let’s repair that:</p>
<pre class="r"><code>movies2 %&gt;% 
  filter(!is.nan(budget_log10)) %&gt;% 
  filter(!is.infinite(budget_log10)) -&gt; movies2a</code></pre>
</div>
<div id="ggscatterstats" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> ggscatterstats</h2>
<p>Let’s try this</p>
<pre class="r"><code>movies2a %&gt;% 
  ggscatterstats(x = budget_log10, y = rating)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-11-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p><a href="https://indrajeetpatil.github.io/ggstatsplot/articles/web_only/ggscatterstats.html">Hier</a> findet sich weitere Erklärung zu diesem Diagramm.</p>
</div>
<div id="pivot-data-set" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Pivot data set</h2>
<pre class="r"><code>movies2a %&gt;% 
  select(budget_log10, rating, Action:Short) %&gt;% 
  pivot_longer(cols = Action:Short, 
               names_to = &quot;genre&quot;) %&gt;% 
  filter(value == 1) -&gt; movies2_long</code></pre>
<p>And plot it:</p>
<pre class="r"><code>movies2_long %&gt;% 
  ggplot() +
  aes(x = budget_log10, y = rating) +
  geom_bin2d() +
  facet_wrap(~ genre) +
  geom_smooth() +
  scale_fill_viridis_c()</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-13-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="drop-unused-variables" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> Drop unused variables</h2>
<p>Let’s keep things simple and drop some variables.</p>
<pre class="r"><code>movies2a %&gt;% 
  select(-c(title, r1:r10, mpaa)) -&gt; movies2a</code></pre>
</div>
<div id="drop-cases-with-missing-values" class="section level2" number="4.9">
<h2><span class="header-section-number">4.9</span> Drop cases with missing values</h2>
<pre class="r"><code>movies2a %&gt;% 
  drop_na() -&gt; movies2_nona  # &quot;no NA&quot; soll das heißen</code></pre>
<p>How many row remain?</p>
<pre class="r"><code>nrow(movies2_nona)  # &quot;no NAs&quot;
#&gt; [1] 5183</code></pre>
<p>That’s unsatisfying. However, for simplicity, let’s stick with that for now.</p>
</div>
</div>
<div id="model-0" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Model 0</h1>
<pre class="r"><code>m0 &lt;- lm(rating ~ 1, data = movies2_nona)</code></pre>
<pre class="r"><code>summary(m0)
#&gt; 
#&gt; Call:
#&gt; lm(formula = rating ~ 1, data = movies2_nona)
#&gt; 
#&gt; Residuals:
#&gt;    Min     1Q Median     3Q    Max 
#&gt; -5.137 -0.937  0.163  1.063  3.863 
#&gt; 
#&gt; Coefficients:
#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    
#&gt; (Intercept)  6.13699    0.02144   286.2   &lt;2e-16 ***
#&gt; ---
#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
#&gt; 
#&gt; Residual standard error: 1.544 on 5182 degrees of freedom</code></pre>
<p>Let’s make that tidy:</p>
<pre class="r"><code>tidy(m0)
#&gt; # A tibble: 1 x 5
#&gt;   term        estimate std.error statistic p.value
#&gt;   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
#&gt; 1 (Intercept)     6.14    0.0214      286.       0</code></pre>
<p>Model fit:</p>
<pre class="r"><code>glance(m0)
#&gt; # A tibble: 1 x 12
#&gt;   r.squared adj.r.squared sigma statistic p.value    df logLik    AIC    BIC
#&gt;       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
#&gt; 1         0             0  1.54        NA      NA    NA -9605. 19213. 19226.
#&gt; # … with 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
<div id="model-1-budget_log10" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Model 1: <code>budget_log10</code></h1>
<pre class="r"><code>movies2_nona %&gt;% 
  drop_na(budget_log10, rating) %&gt;% 
  lm(rating ~ budget_log10, data = .)  -&gt; m1</code></pre>
<pre class="r"><code>tidy(m1)
#&gt; # A tibble: 2 x 5
#&gt;   term         estimate std.error statistic      p.value
#&gt;   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;
#&gt; 1 (Intercept)     6.77     0.113      60.0  0           
#&gt; 2 budget_log10   -0.101    0.0178     -5.68 0.0000000142</code></pre>
<p>Model fit:</p>
<pre class="r"><code>glance(m1)
#&gt; # A tibble: 1 x 12
#&gt;   r.squared adj.r.squared sigma statistic     p.value    df logLik    AIC    BIC
#&gt;       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
#&gt; 1   0.00619       0.00600  1.54      32.3     1.42e-8     1 -9589. 19183. 19203.
#&gt; # … with 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
<div id="model-2-adding-number-of-votes" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Model 2: Adding number of votes</h1>
<pre class="r"><code>p1 &lt;- movies2_nona %&gt;% 
  ggplot(aes(x = votes)) +
  geom_histogram() +
  labs(title = &quot;Datensatz: movies2_train&quot;)

p1</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-24-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Log-transform <code>votes</code>:</p>
<pre class="r"><code>movies2_nona %&gt;% 
  mutate(votes_log10 = log10(votes)) %&gt;% 
  select(-votes) -&gt; movies3_nona</code></pre>
<pre class="r"><code>movies3_nona %&gt;% 
   lm(rating ~ votes_log10, data = .) -&gt; m2

m2 %&gt;% 
  tidy()
#&gt; # A tibble: 2 x 5
#&gt;   term        estimate std.error statistic  p.value
#&gt;   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
#&gt; 1 (Intercept)    5.67     0.0564    100.   0.      
#&gt; 2 votes_log10    0.170    0.0191      8.90 7.80e-19

glance(m2)
#&gt; # A tibble: 1 x 12
#&gt;   r.squared adj.r.squared sigma statistic  p.value    df logLik    AIC    BIC
#&gt;       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
#&gt; 1    0.0150        0.0149  1.53      79.2 7.80e-19     1 -9565. 19137. 19156.
#&gt; # … with 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
<div id="model-3-number-of-votes-quadratic" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Model 3: Number of votes, quadratic</h1>
<pre class="r"><code>m3 &lt;- lm(rating ~ I(votes_log10^2) + votes_log10, data = movies3_nona)</code></pre>
<pre class="r"><code>tidy(m3)
#&gt; # A tibble: 3 x 5
#&gt;   term             estimate std.error statistic   p.value
#&gt;   &lt;chr&gt;               &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
#&gt; 1 (Intercept)         8.24     0.110       74.8 0.       
#&gt; 2 I(votes_log10^2)    0.444    0.0167      26.6 8.67e-146
#&gt; 3 votes_log10        -2.18     0.0904     -24.1 3.75e-122</code></pre>
<pre class="r"><code>glance(m3)
#&gt; # A tibble: 1 x 12
#&gt;   r.squared adj.r.squared sigma statistic   p.value    df logLik    AIC    BIC
#&gt;       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
#&gt; 1     0.133         0.133  1.44      398. 2.39e-161     2 -9235. 18477. 18503.
#&gt; # … with 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
<pre class="r"><code>movies3_nona %&gt;% 
  ggplot(aes(x = votes_log10, y = rating)) +
  geom_point(alpha = .2) +
  geom_smooth(method = &quot;lm&quot;, se = FALSE,
                formula = y ~ poly(x, 2))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-30-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="model-4-number-of-votes-3rd-degree" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Model 4: Number of votes, 3rd degree</h1>
<pre class="r"><code>movies3_nona %&gt;% 
  ggplot(aes(x = votes_log10, y = rating)) +
  geom_point(alpha = .2) +
  geom_smooth(method = &quot;lm&quot;, se = FALSE,
                formula = y ~ poly(x, 3))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-31-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>m4 &lt;- lm(rating ~ poly(votes_log10, degree = 3), 
         data = movies3_nona)</code></pre>
<pre class="r"><code>tidy(m4)
#&gt; # A tibble: 4 x 5
#&gt;   term                           estimate std.error statistic   p.value
#&gt;   &lt;chr&gt;                             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
#&gt; 1 (Intercept)                        6.14    0.0199    308.   0.       
#&gt; 2 poly(votes_log10, degree = 3)1    13.6     1.43        9.50 2.98e- 21
#&gt; 3 poly(votes_log10, degree = 3)2    38.2     1.43       26.6  1.99e-146
#&gt; 4 poly(votes_log10, degree = 3)3    -7.26    1.43       -5.06 4.27e-  7
glance(m4)
#&gt; # A tibble: 1 x 12
#&gt;   r.squared adj.r.squared sigma statistic   p.value    df logLik    AIC    BIC
#&gt;       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
#&gt; 1     0.137         0.137  1.43      275. 1.53e-165     3 -9222. 18454. 18486.
#&gt; # … with 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
<div id="model-5-multiple-regression" class="section level1" number="10">
<h1><span class="header-section-number">10</span> Model 5: Multiple regression</h1>
<pre class="r"><code>m5 &lt;- lm(rating ~ votes_log10 + budget_log10, data = movies3_nona)</code></pre>
<pre class="r"><code>glance(m5)
#&gt; # A tibble: 1 x 12
#&gt;   r.squared adj.r.squared sigma statistic   p.value    df logLik    AIC    BIC
#&gt;       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
#&gt; 1    0.0877        0.0874  1.47      249. 5.02e-104     2 -9367. 18741. 18768.
#&gt; # … with 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
<div id="model-6-interaction" class="section level1" number="11">
<h1><span class="header-section-number">11</span> Model 6: Interaction</h1>
<pre class="r"><code>m6 &lt;- lm(rating ~ votes_log10 + budget_log10 + votes_log10:budget_log10,
         data = movies3_nona)</code></pre>
</div>
<div id="model-selection-anova" class="section level1" number="12">
<h1><span class="header-section-number">12</span> Model selection: ANOVA</h1>
<pre class="r"><code>anova(m0,  m2, m3, m4)
#&gt; Analysis of Variance Table
#&gt; 
#&gt; Model 1: rating ~ 1
#&gt; Model 2: rating ~ votes_log10
#&gt; Model 3: rating ~ I(votes_log10^2) + votes_log10
#&gt; Model 4: rating ~ poly(votes_log10, degree = 3)
#&gt;   Res.Df   RSS Df Sum of Sq       F    Pr(&gt;F)    
#&gt; 1   5182 12351                                   
#&gt; 2   5181 12165  1    185.86  90.341 &lt; 2.2e-16 ***
#&gt; 3   5180 10707  1   1457.68 708.550 &lt; 2.2e-16 ***
#&gt; 4   5179 10655  1     52.74  25.636 4.265e-07 ***
#&gt; ---
#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>This test assesses:</p>
<p><span class="math display">\[F =\frac{(TSS-RSS)/p}{RSS/(n-p-1)}\]</span></p>
<pre class="r"><code>glance(m6)
#&gt; # A tibble: 1 x 12
#&gt;   r.squared adj.r.squared sigma statistic   p.value    df logLik    AIC    BIC
#&gt;       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
#&gt; 1     0.117         0.117  1.45      230. 6.88e-140     3 -9281. 18572. 18605.
#&gt; # … with 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
<div id="regression-diagnostics-testing-the-assumptions" class="section level1" number="13">
<h1><span class="header-section-number">13</span> Regression diagnostics: testing the assumptions</h1>
<p>Let’s pick a model and visualize some diagnostics.</p>
<pre class="r"><code>ggplot2::autoplot(m4) + theme_minimal()</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-39-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="reproducibility" class="section level1" number="14">
<h1><span class="header-section-number">14</span> Reproducibility</h1>
<pre><code>#&gt; ─ Session info ───────────────────────────────────────────────────────────────────────────────────────────────────────
#&gt;  setting  value                       
#&gt;  version  R version 4.0.2 (2020-06-22)
#&gt;  os       macOS  10.16                
#&gt;  system   x86_64, darwin17.0          
#&gt;  ui       X11                         
#&gt;  language (EN)                        
#&gt;  collate  en_US.UTF-8                 
#&gt;  ctype    en_US.UTF-8                 
#&gt;  tz       Europe/Berlin               
#&gt;  date     2021-02-24                  
#&gt; 
#&gt; ─ Packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────
#&gt;  package     * version     date       lib source                             
#&gt;  assertthat    0.2.1       2019-03-21 [1] CRAN (R 4.0.0)                     
#&gt;  backports     1.2.1       2020-12-09 [1] CRAN (R 4.0.2)                     
#&gt;  blogdown      1.1         2021-01-19 [1] CRAN (R 4.0.2)                     
#&gt;  bookdown      0.21.6      2021-02-02 [1] Github (rstudio/bookdown@6c7346a)  
#&gt;  broom         0.7.5       2021-02-19 [1] CRAN (R 4.0.2)                     
#&gt;  bslib         0.2.4.9000  2021-02-02 [1] Github (rstudio/bslib@b3cd7a9)     
#&gt;  cachem        1.0.4       2021-02-13 [1] CRAN (R 4.0.2)                     
#&gt;  callr         3.5.1       2020-10-13 [1] CRAN (R 4.0.2)                     
#&gt;  cellranger    1.1.0       2016-07-27 [1] CRAN (R 4.0.0)                     
#&gt;  cli           2.3.1       2021-02-23 [1] CRAN (R 4.0.2)                     
#&gt;  codetools     0.2-16      2018-12-24 [2] CRAN (R 4.0.2)                     
#&gt;  colorspace    2.0-0       2020-11-11 [1] CRAN (R 4.0.2)                     
#&gt;  crayon        1.4.1       2021-02-08 [1] CRAN (R 4.0.2)                     
#&gt;  DBI           1.1.1       2021-01-15 [1] CRAN (R 4.0.2)                     
#&gt;  dbplyr        2.1.0       2021-02-03 [1] CRAN (R 4.0.2)                     
#&gt;  debugme       1.1.0       2017-10-22 [1] CRAN (R 4.0.0)                     
#&gt;  desc          1.2.0       2018-05-01 [1] CRAN (R 4.0.0)                     
#&gt;  devtools      2.3.2       2020-09-18 [1] CRAN (R 4.0.2)                     
#&gt;  digest        0.6.27      2020-10-24 [1] CRAN (R 4.0.2)                     
#&gt;  dplyr       * 1.0.4       2021-02-02 [1] CRAN (R 4.0.2)                     
#&gt;  ellipsis      0.3.1       2020-05-15 [1] CRAN (R 4.0.0)                     
#&gt;  evaluate      0.14        2019-05-28 [1] CRAN (R 4.0.0)                     
#&gt;  fansi         0.4.2       2021-01-15 [1] CRAN (R 4.0.2)                     
#&gt;  fastmap       1.1.0       2021-01-25 [1] CRAN (R 4.0.2)                     
#&gt;  forcats     * 0.5.1       2021-01-27 [1] CRAN (R 4.0.2)                     
#&gt;  fs            1.5.0       2020-07-31 [1] CRAN (R 4.0.2)                     
#&gt;  generics      0.1.0       2020-10-31 [1] CRAN (R 4.0.2)                     
#&gt;  ggplot2     * 3.3.3       2020-12-30 [1] CRAN (R 4.0.2)                     
#&gt;  glue          1.4.2       2020-08-27 [1] CRAN (R 4.0.2)                     
#&gt;  gtable        0.3.0       2019-03-25 [1] CRAN (R 4.0.0)                     
#&gt;  haven         2.3.1       2020-06-01 [1] CRAN (R 4.0.0)                     
#&gt;  hms           1.0.0       2021-01-13 [1] CRAN (R 4.0.2)                     
#&gt;  htmltools     0.5.1.1     2021-01-22 [1] CRAN (R 4.0.2)                     
#&gt;  httr          1.4.2       2020-07-20 [1] CRAN (R 4.0.2)                     
#&gt;  jquerylib     0.1.3       2020-12-17 [1] CRAN (R 4.0.2)                     
#&gt;  jsonlite      1.7.2       2020-12-09 [1] CRAN (R 4.0.2)                     
#&gt;  knitr         1.31        2021-01-27 [1] CRAN (R 4.0.2)                     
#&gt;  lifecycle     1.0.0       2021-02-15 [1] CRAN (R 4.0.2)                     
#&gt;  lubridate     1.7.9.2     2020-11-13 [1] CRAN (R 4.0.2)                     
#&gt;  magrittr      2.0.1       2020-11-17 [1] CRAN (R 4.0.2)                     
#&gt;  memoise       2.0.0       2021-01-26 [1] CRAN (R 4.0.2)                     
#&gt;  modelr        0.1.8       2020-05-19 [1] CRAN (R 4.0.0)                     
#&gt;  munsell       0.5.0       2018-06-12 [1] CRAN (R 4.0.0)                     
#&gt;  pillar        1.5.0       2021-02-22 [1] CRAN (R 4.0.2)                     
#&gt;  pkgbuild      1.2.0       2020-12-15 [1] CRAN (R 4.0.2)                     
#&gt;  pkgconfig     2.0.3       2019-09-22 [1] CRAN (R 4.0.0)                     
#&gt;  pkgload       1.2.0       2021-02-23 [1] CRAN (R 4.0.2)                     
#&gt;  prettyunits   1.1.1       2020-01-24 [1] CRAN (R 4.0.0)                     
#&gt;  processx      3.4.5       2020-11-30 [1] CRAN (R 4.0.2)                     
#&gt;  ps            1.5.0       2020-12-05 [1] CRAN (R 4.0.2)                     
#&gt;  purrr       * 0.3.4       2020-04-17 [1] CRAN (R 4.0.0)                     
#&gt;  R6            2.5.0       2020-10-28 [1] CRAN (R 4.0.2)                     
#&gt;  Rcpp          1.0.6       2021-01-15 [1] CRAN (R 4.0.2)                     
#&gt;  readr       * 1.4.0       2020-10-05 [1] CRAN (R 4.0.2)                     
#&gt;  readxl        1.3.1       2019-03-13 [1] CRAN (R 4.0.0)                     
#&gt;  remotes       2.2.0       2020-07-21 [1] CRAN (R 4.0.2)                     
#&gt;  reprex        1.0.0       2021-01-27 [1] CRAN (R 4.0.2)                     
#&gt;  rlang         0.4.10      2020-12-30 [1] CRAN (R 4.0.2)                     
#&gt;  rmarkdown     2.7         2021-02-19 [1] CRAN (R 4.0.2)                     
#&gt;  rprojroot     2.0.2       2020-11-15 [1] CRAN (R 4.0.2)                     
#&gt;  rstudioapi    0.13.0-9000 2021-02-11 [1] Github (rstudio/rstudioapi@9d21f50)
#&gt;  rvest         0.3.6       2020-07-25 [1] CRAN (R 4.0.2)                     
#&gt;  sass          0.3.1       2021-01-24 [1] CRAN (R 4.0.2)                     
#&gt;  scales        1.1.1       2020-05-11 [1] CRAN (R 4.0.0)                     
#&gt;  sessioninfo   1.1.1       2018-11-05 [1] CRAN (R 4.0.0)                     
#&gt;  stringi       1.5.3       2020-09-09 [1] CRAN (R 4.0.2)                     
#&gt;  stringr     * 1.4.0       2019-02-10 [1] CRAN (R 4.0.0)                     
#&gt;  testthat      3.0.2       2021-02-14 [1] CRAN (R 4.0.2)                     
#&gt;  tibble      * 3.0.6       2021-01-29 [1] CRAN (R 4.0.2)                     
#&gt;  tidyr       * 1.1.2       2020-08-27 [1] CRAN (R 4.0.2)                     
#&gt;  tidyselect    1.1.0       2020-05-11 [1] CRAN (R 4.0.0)                     
#&gt;  tidyverse   * 1.3.0       2019-11-21 [1] CRAN (R 4.0.0)                     
#&gt;  usethis       2.0.1       2021-02-10 [1] CRAN (R 4.0.2)                     
#&gt;  utf8          1.1.4       2018-05-24 [1] CRAN (R 4.0.0)                     
#&gt;  vctrs         0.3.6       2020-12-17 [1] CRAN (R 4.0.2)                     
#&gt;  withr         2.4.1       2021-01-26 [1] CRAN (R 4.0.2)                     
#&gt;  xfun          0.21        2021-02-10 [1] CRAN (R 4.0.2)                     
#&gt;  xml2          1.3.2       2020-04-23 [1] CRAN (R 4.0.0)                     
#&gt;  yaml          2.2.1       2020-02-01 [1] CRAN (R 4.0.0)                     
#&gt; 
#&gt; [1] /Users/sebastiansaueruser/Rlibs
#&gt; [2] /Library/Frameworks/R.framework/Versions/4.0/Resources/library</code></pre>
</div>
